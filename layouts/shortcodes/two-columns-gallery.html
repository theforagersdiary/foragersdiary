<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/css/lightbox.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox.min.js"></script>

<div class="two-columns-container grid grid-cols-1 md:grid-cols-2 gap-5">
    <!-- Left Column: Render Markdown content -->
    <div class="left-column">
        {{ .Inner | markdownify }}
    </div>

    <!-- Right Column: Gallery -->
    <div class="right-column">
        {{ $featuredImages := .Page.Resources.Match "*featured*" }}
        {{ $featured := index $featuredImages 0 }}
        {{ $images := .Page.Resources.Match "*" }}

        <div class="featgallery-container">

            {{ if $featured }}
                <!-- Featured Image (Resized with aspect ratio retained, max width 450px) -->
                {{ $resizedFeatured := $featured.Resize "450x" }}
                <div class="featgallery-featured-image">
                    <a href="{{ $featured.Permalink }}" data-lightbox="gallery">
                        <img src="{{ $resizedFeatured.RelPermalink }}" alt="Featured Image" style="max-width: 450px;" />
                    </a>
                </div>
                
                <!-- Thumbnail Grid -->
                <div class="featgallery-thumbnail-grid grid grid-cols-3 gap-4 mt-4">
                    <!-- Loop through all images but skip the featured image -->
                    {{ range $images }}
                        {{ if not (eq . $featured) }} <!-- Exclude the featured image from the grid -->
                            {{ $resized := .Fill "150x150 q60" }} <!-- Create square thumbnails for other images -->
                            <a href="{{ .Permalink }}" data-lightbox="gallery">
                                <img src="{{ $resized.RelPermalink }}" alt="Thumbnail" class="featgallery-thumbnail-image"/>
                            </a>
                        {{ end }}
                    {{ end }}
                </div>

            {{ end }}
        </div>
    </div>
</div>